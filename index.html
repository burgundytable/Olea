<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Olea Education: Institutional DNA Calibration</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts: Gantari (Body) & Outfit (Display) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gantari:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        olea: {
                            base: '#f9f5ef',    // Cream Background
                            primary: '#123d07', // Deep Olive
                            secondary: '#4a6b41', // Lighter Olive
                            accent: '#d4b06a',  // Gold/Bronze accent
                            light: '#e3ebe3',
                            hover: '#0a2404',
                            text: '#1c1917'
                        }
                    },
                    fontFamily: {
                        sans: ['Gantari', 'sans-serif'],
                        display: ['Outfit', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #f9f5ef; color: #123d07; }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f9f5ef; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #123d07; border-radius: 10px; }
        
        /* Card Hover Effects */
        .school-card { transition: all 0.3s ease; }
        .school-card:hover { transform: translateY(-5px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }

        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* DNA Pill Styles */
        .dna-pill { @apply px-2 py-0.5 rounded text-[10px] font-bold tracking-wider uppercase border; }
        
        /* Filter Button Active State */
        .filter-btn.active { @apply bg-olea-primary text-white border-olea-primary; }

        /* Quiz Card Interactions */
        .quiz-option-card { transition: all 0.2s ease; border: 2px solid #e5e7eb; }
        .quiz-option-card:hover { border-color: #123d07; transform: translateY(-2px); }
        
        .quiz-btn { transition: all 0.2s; }
        .quiz-btn:hover { transform: scale(1.05); }
    </style>
</head>
<body class="min-h-screen flex flex-col antialiased selection:bg-olea-primary selection:text-white">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-olea-primary text-olea-base shadow-lg backdrop-blur-md bg-opacity-95">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-4">
                <div class="w-8 h-8 rounded-full border border-olea-base flex items-center justify-center">
                    <div class="w-2 h-2 bg-olea-base rounded-full"></div>
                </div>
                <div>
                    <h1 class="font-display font-bold text-xl tracking-tight leading-none">OLEA EDUCATION</h1>
                    <p class="text-[9px] uppercase tracking-[0.3em] opacity-70">Institutional DNA Calibration</p>
                </div>
            </div>
            <div class="hidden md:flex gap-6 text-sm font-medium tracking-wide">
                <a href="#" onclick="resetApp()" class="hover:text-olea-accent transition">The Archetypes</a>
                <a href="#" onclick="startQuiz()" class="hover:text-olea-accent transition">Diagnostic (72)</a>
                <span class="opacity-30">|</span>
                <span id="user-code-display" class="font-mono text-olea-accent">GUEST</span>
            </div>
        </div>
    </nav>

    <!-- Hero / Control Panel -->
    <header class="bg-white/50 border-b border-olea-primary/5 py-12">
        <div class="container mx-auto px-6 max-w-6xl text-center">
            <h2 class="text-3xl md:text-5xl font-display font-bold text-olea-primary mb-4">Cultivating Eunoia</h2>
            <p class="text-lg text-stone-600 font-light max-w-2xl mx-auto mb-8">
                The <strong>Olea Archetype System™</strong> decodes the "Institutional DNA" of the Top 50 universities. 
                Complete the full 72-point calibration to calculate the precise distance between your profile and your target school.
            </p>

            <div class="flex flex-wrap justify-center gap-4">
                <button onclick="startQuiz()" class="bg-olea-primary text-olea-base px-8 py-3 rounded-lg font-display font-bold shadow-xl hover:bg-olea-hover hover:scale-105 transition duration-300 flex items-center gap-2">
                    <i class="fas fa-fingerprint"></i> Full DNA Calibration (72)
                </button>
                <button onclick="document.getElementById('directory-section').scrollIntoView({behavior:'smooth'})" class="bg-white text-olea-primary border border-olea-primary/20 px-8 py-3 rounded-lg font-display font-bold shadow-sm hover:bg-olea-light transition duration-300">
                    Browse Directory (51)
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="directory-section" class="flex-grow container mx-auto px-6 py-12">
        
        <!-- Detailed Filter Bar -->
        <div class="mb-10 space-y-4">
            <div class="flex flex-wrap justify-center gap-2 text-sm">
                <span class="py-2 px-3 text-stone-400 font-bold uppercase text-xs tracking-widest flex items-center">Identity:</span>
                <button onclick="filterGrid('All')" class="filter-btn active px-4 py-2 rounded-full border border-olea-primary/20 text-olea-primary transition">All</button>
                
                <!-- Mind -->
                <div class="w-px h-8 bg-olea-primary/10 mx-2"></div>
                <button onclick="filterGrid('C')" class="filter-btn px-4 py-2 rounded-full border border-olea-primary/20 hover:bg-olea-primary/5 transition text-olea-primary">Conceptual (C)</button>
                <button onclick="filterGrid('A')" class="filter-btn px-4 py-2 rounded-full border border-olea-primary/20 hover:bg-olea-primary/5 transition text-olea-primary">Applied (A)</button>
                
                <!-- Social -->
                <div class="w-px h-8 bg-olea-primary/10 mx-2"></div>
                <button onclick="filterGrid('S')" class="filter-btn px-4 py-2 rounded-full border border-olea-primary/20 hover:bg-olea-primary/5 transition text-olea-primary">Solo (S)</button>
                <button onclick="filterGrid('K')" class="filter-btn px-4 py-2 rounded-full border border-olea-primary/20 hover:bg-olea-primary/5 transition text-olea-primary">Kinship (K)</button>
                
                <!-- Path -->
                <div class="w-px h-8 bg-olea-primary/10 mx-2"></div>
                <button onclick="filterGrid('F')" class="filter-btn px-4 py-2 rounded-full border border-olea-primary/20 hover:bg-olea-primary/5 transition text-olea-primary">Fluid (F)</button>
                <button onclick="filterGrid('D')" class="filter-btn px-4 py-2 rounded-full border border-olea-primary/20 hover:bg-olea-primary/5 transition text-olea-primary">Directed (D)</button>

                <!-- Spirit -->
                <div class="w-px h-8 bg-olea-primary/10 mx-2"></div>
                <button onclick="filterGrid('E')" class="filter-btn px-4 py-2 rounded-full border border-olea-primary/20 hover:bg-olea-primary/5 transition text-olea-primary">Established (E)</button>
                <button onclick="filterGrid('V')" class="filter-btn px-4 py-2 rounded-full border border-olea-primary/20 hover:bg-olea-primary/5 transition text-olea-primary">Visionary (V)</button>
            </div>
            
            <div class="flex flex-wrap justify-center gap-2 text-sm">
                <span class="py-2 px-3 text-stone-400 font-bold uppercase text-xs tracking-widest flex items-center">Habitat:</span>
                
                <!-- Env -->
                <button onclick="filterGrid('M')" class="filter-btn px-4 py-2 rounded-full border border-stone-200 text-stone-600 hover:border-olea-primary hover:text-olea-primary transition">Metro (M)</button>
                <button onclick="filterGrid('G')" class="filter-btn px-4 py-2 rounded-full border border-stone-200 text-stone-600 hover:border-olea-primary hover:text-olea-primary transition">Grove (G)</button>
                
                <!-- Focus -->
                <div class="w-px h-8 bg-stone-200 mx-2"></div>
                <button onclick="filterGrid('R')" class="filter-btn px-4 py-2 rounded-full border border-stone-200 text-stone-600 hover:border-olea-primary hover:text-olea-primary transition">Research (R)</button>
                <button onclick="filterGrid('U')" class="filter-btn px-4 py-2 rounded-full border border-stone-200 text-stone-600 hover:border-olea-primary hover:text-olea-primary transition">Undergrad (U)</button>
            </div>
        </div>

        <!-- School Grid -->
        <div id="school-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Injected via JS -->
        </div>

    </main>

    <!-- MODAL: School Details -->
    <div id="school-modal" class="fixed inset-0 bg-olea-primary/60 backdrop-blur-md hidden z-[60] flex items-center justify-center p-4">
        <div class="bg-olea-base w-full max-w-5xl h-[85vh] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-hidden relative fade-in">
            <button onclick="closeModal()" class="absolute top-4 right-4 z-10 text-stone-400 hover:text-olea-primary transition"><i class="fas fa-times fa-2x"></i></button>

            <!-- Sidebar: The DNA -->
            <div class="w-full md:w-1/3 bg-white border-r border-olea-primary/10 p-8 overflow-y-auto custom-scrollbar">
                <div class="mb-6">
                    <span id="modal-rank" class="bg-stone-100 text-stone-500 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wider">Rank #1</span>
                    <h2 id="modal-name" class="text-3xl font-display font-bold text-olea-primary mt-2 leading-none">School Name</h2>
                    <p id="modal-code" class="font-mono text-xl text-olea-accent mt-2 tracking-widest">XXXX-XX</p>
                </div>

                <!-- DNA Visualization -->
                <div class="space-y-4 mb-8">
                    <h3 class="text-xs font-bold text-stone-400 uppercase tracking-widest border-b border-stone-100 pb-2">Genetic Profile</h3>
                    <div id="modal-dna-visuals" class="space-y-3"></div>
                </div>

                <div class="mt-auto">
                    <button id="modal-compare-btn" class="w-full py-3 border border-olea-primary text-olea-primary rounded-lg font-bold hover:bg-olea-primary hover:text-white transition uppercase text-xs tracking-widest">
                        Add to Comparison
                    </button>
                </div>
            </div>

            <!-- Content: The Narrative -->
            <div class="w-full md:w-2/3 p-8 md:p-12 overflow-y-auto custom-scrollbar bg-olea-base">
                <div class="mb-10">
                    <h4 class="text-xs font-bold text-olea-secondary uppercase tracking-widest mb-3">The Olea Persona</h4>
                    <p id="modal-persona" class="text-2xl md:text-3xl font-display font-medium text-olea-primary italic leading-tight">
                        "The Persona Description."
                    </p>
                </div>

                <div class="grid grid-cols-1 gap-8">
                    <div class="bg-white p-6 rounded-xl border border-olea-primary/5 shadow-sm">
                        <h4 class="text-sm font-bold text-olea-primary uppercase tracking-wide mb-3 flex items-center gap-2">
                            <i class="fas fa-chess-knight"></i> Strategic Translation
                        </h4>
                        <p id="modal-strategy" class="text-stone-700 leading-relaxed font-light">
                            Strategy goes here.
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-3">Core Values</h4>
                            <ul id="modal-values" class="space-y-2 text-sm text-stone-600"></ul>
                        </div>
                        <div>
                            <h4 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-3">Evidence Markers</h4>
                            <ul id="modal-evidence" class="space-y-2 text-sm text-stone-600 font-mono text-xs"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL: Diagnostic Quiz (Large UI) -->
    <div id="quiz-modal" class="fixed inset-0 bg-olea-primary/95 hidden z-[70] flex flex-col items-center justify-center p-4">
        <div class="w-full max-w-6xl h-full md:h-auto">
            <!-- Header -->
            <div class="flex justify-between items-end mb-6 text-olea-base px-4">
                <div>
                    <h2 class="text-2xl md:text-3xl font-display font-bold">DNA Calibration</h2>
                    <p id="quiz-section-title" class="text-olea-accent text-sm font-bold mt-1 uppercase tracking-widest">Part I: The Mind</p>
                </div>
                <div class="text-right">
                    <span id="quiz-step" class="text-3xl md:text-4xl font-display font-bold text-olea-accent">1</span>
                    <span class="text-sm text-olea-light/40">/ 72</span>
                </div>
            </div>

            <!-- Card -->
            <div id="quiz-card" class="bg-olea-base rounded-2xl shadow-2xl p-6 md:p-10 relative overflow-hidden min-h-[600px] flex flex-col justify-center">
                <button onclick="closeQuiz()" class="absolute top-4 right-4 text-stone-300 hover:text-olea-primary z-10"><i class="fas fa-times"></i></button>
                
                <div id="quiz-question-container" class="fade-in">
                    <p id="quiz-text" class="text-lg md:text-xl font-medium text-stone-500 mb-10 text-center italic max-w-2xl mx-auto">
                        Select the statement that resonates most with you.
                    </p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-4">
                        <!-- Option A Card -->
                        <div class="quiz-option-card bg-white p-8 rounded-xl cursor-default flex flex-col justify-between h-72 relative group">
                            <div class="text-center">
                                <span class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-2 block">Option A</span>
                                <p id="opt-1-text" class="text-2xl font-display font-bold text-olea-primary leading-tight">Option A Text</p>
                            </div>
                            
                            <!-- Interaction Buttons (Bottom of Card) -->
                            <div class="grid grid-cols-2 gap-3 mt-6">
                                <button onclick="handleAnswer(1)" class="quiz-btn py-3 bg-olea-primary text-white rounded-lg font-bold text-sm uppercase tracking-wide shadow-md hover:bg-olea-hover">Strongly</button>
                                <button onclick="handleAnswer(2)" class="quiz-btn py-3 bg-olea-light text-olea-primary border border-olea-primary/20 rounded-lg font-bold text-sm uppercase tracking-wide hover:bg-white">Leaning</button>
                            </div>
                        </div>

                        <!-- Option B Card -->
                        <div class="quiz-option-card bg-white p-8 rounded-xl cursor-default flex flex-col justify-between h-72 relative group">
                            <div class="text-center">
                                <span class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-2 block">Option B</span>
                                <p id="opt-2-text" class="text-2xl font-display font-bold text-olea-primary leading-tight">Option B Text</p>
                            </div>
                            
                            <!-- Interaction Buttons (Bottom of Card) -->
                            <div class="grid grid-cols-2 gap-3 mt-6">
                                <button onclick="handleAnswer(4)" class="quiz-btn py-3 bg-olea-light text-olea-primary border border-olea-primary/20 rounded-lg font-bold text-sm uppercase tracking-wide hover:bg-white">Leaning</button>
                                <button onclick="handleAnswer(5)" class="quiz-btn py-3 bg-olea-primary text-white rounded-lg font-bold text-sm uppercase tracking-wide shadow-md hover:bg-olea-hover">Strongly</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="handleAnswer(3)" class="text-xs text-stone-400 hover:text-stone-600 underline">I am truly neutral on this (Score 3)</button>
                    </div>

                </div>

                <!-- Result View -->
                <div id="quiz-result-view" class="hidden text-center fade-in flex-col justify-center h-full">
                    <div class="w-24 h-24 rounded-full bg-olea-primary text-olea-accent flex items-center justify-center mx-auto mb-6 text-4xl font-mono border-4 border-olea-accent">
                        <span id="result-code-final">CSFE</span>
                    </div>
                    <h3 class="text-2xl font-display font-bold text-olea-primary mb-2">Calibration Complete</h3>
                    <p id="result-archetype-name" class="text-lg text-olea-secondary font-medium italic mb-6">"The Philosopher King"</p>
                    <p class="text-stone-600 mb-8 max-w-md mx-auto text-sm">
                        Your strategic DNA has been mapped. We have filtered the directory to highlight your "High Match" institutions.
                    </p>
                    <button onclick="finalizeQuiz()" class="bg-olea-primary text-white px-8 py-3 rounded-lg font-bold shadow-lg hover:bg-olea-hover transition">
                        View Strategic Matches
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Comparison Tray -->
    <div id="comparison-tray" class="fixed bottom-0 left-0 right-0 bg-white border-t-4 border-olea-primary shadow-[0_-10px_40px_rgba(0,0,0,0.1)] transform translate-y-full transition-transform duration-300 z-40">
        <div class="container mx-auto px-6 py-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-sm font-bold text-olea-primary flex items-center gap-2 uppercase tracking-wide">
                    <i class="fas fa-balance-scale"></i> Comparison
                </h3>
                <button onclick="toggleComparison()" class="text-stone-400 hover:text-olea-primary transition"><i class="fas fa-chevron-down"></i></button>
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div id="slot-0" class="p-4 bg-stone-50 rounded border border-dashed border-stone-300 text-center text-xs text-stone-400">Empty Slot</div>
                <div id="slot-1" class="p-4 bg-stone-50 rounded border border-dashed border-stone-300 text-center text-xs text-stone-400">Empty Slot</div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATA: THE INSTITUTIONAL DNA (Full 50+ Schools) ---
        const universities = [
            // IVY LEAGUE (8)
            { id: "princeton", name: "Princeton University", rank: 1, code: "CKFE-GU", persona: "The Conceptual Village", desc: "Theoretical, tight-knit, open path, traditional. The ultimate 'Undergrad Grove'.", strategy: "Emphasize pure theory and the Senior Thesis.", evidence: ["Senior Thesis Mandatory", "Eating Clubs"] },
            { id: "harvard", name: "Harvard University", rank: 3, code: "ASFE-MR", persona: "The Applied Star", desc: "Action-oriented, independent, flexible path. A massive 'Research Metro'.", strategy: "Show massive scale of impact and solo leadership.", evidence: ["Extension School", "Massive Endowment"] },
            { id: "yale", name: "Yale University", rank: 5, code: "CKFE-GU", persona: "The Humanist Village", desc: "Similar to Princeton but slightly more socially fluid. Traditional but supportive.", strategy: "Highlight 'Kinship' and the Residential Colleges.", evidence: ["Residential Colleges", "Global Strategy"] },
            { id: "columbia", name: "Columbia University", rank: 12, code: "CSDE-MR", persona: "The Directed Intellectual", desc: "Deeply theoretical (Core), solo/independent, very structured. NYC intensity.", strategy: "You must love the Core Curriculum and NYC grit.", evidence: ["The Core Curriculum", "Butler Library"] },
            { id: "penn", name: "UPenn", rank: 7, code: "ASDE-MR", persona: "The Pragmatic Operator", desc: "Applied/Pre-professional, competitive, structured. Traditional prestige.", strategy: "Connect theory to practice immediately.", evidence: ["Wharton Influence", "One University Policy"] },
            { id: "brown", name: "Brown University", rank: 13, code: "CKFV-GU", persona: "The Happy Architect", desc: "Conceptual but creative, highly collaborative, fluid path, slightly visionary.", strategy: "Demonstrate ability to handle the Open Curriculum.", evidence: ["Open Curriculum", "S/NC Grading"] },
            { id: "dartmouth", name: "Dartmouth College", rank: 12, code: "AKDE-GU", persona: "The Loyal Captain", desc: "Applied/Active, intense kinship, directed (D-Plan), very traditional.", strategy: "Focus on the 'Grove' (Nature) and the D-Plan.", evidence: ["D-Plan", "Greek Life Dominance"] },
            { id: "cornell", name: "Cornell University", rank: 17, code: "ASDE-GR", persona: "The Vocational Giant", desc: "Applied, independent, structured (Colleges), traditional research-heavy.", strategy: "Fit to Major/College is critical.", evidence: ["Distinct Colleges", "Any Person Any Study"] },

            // TECH & INNOVATION (5)
            { id: "mit", name: "MIT", rank: 2, code: "AKDV-MR", persona: "The Collaborative Hacker", desc: "Applied, collaborative (Kinship via suffering), structured, visionary.", strategy: "Mens et Manus. Show you build things with others.", evidence: ["Hacks", "Mens et Manus"] },
            { id: "stanford", name: "Stanford University", rank: 3, code: "ASFV-GR", persona: "The Visionary Star", desc: "Applied/Entrepreneurial, independent, fluid path. Visionary status.", strategy: "Intellectual Vitality + Innovation.", evidence: ["Silicon Valley", "D-School"] },
            { id: "caltech", name: "Caltech", rank: 9, code: "CSDV-GR", persona: "The Pure Scientist", desc: "Conceptual/Theory-heavy, solo/intense, highly directed, visionary science.", strategy: "Pure 'Conceptual' rigor. Honor code.", evidence: ["Honor Code", "House System"] },
            { id: "cmu", name: "Carnegie Mellon", rank: 22, code: "AKDV-MR", persona: "The Interdisciplinary Specialist", desc: "Applied, kinship (within majors), directed, visionary maker culture.", strategy: "My heart is in the work. Specific interdisciplinary focus.", evidence: ["SCS #1", "Tartan Soul"] },
            { id: "gatech", name: "Georgia Tech", rank: 33, code: "AKDV-MR", persona: "The Public Engineer", desc: "Intense Applied focus, Kinship through rigor, Metro (Atlanta).", strategy: "Show grit and engineering prowess.", evidence: ["Helluva Engineer", "Atlanta Hub"] },

            // CHICAGO STYLE (5)
            { id: "uchicago", name: "UChicago", rank: 6, code: "CSDE-MR", persona: "The Theory Fortress", desc: "Conceptual, solo/debate-heavy, directed (Core), established prestige.", strategy: "Life of the Mind. Love the 'Why'.", evidence: ["The Core", "Scav Hunt"] },
            { id: "jhu", name: "Johns Hopkins", rank: 7, code: "ASDE-MR", persona: "The Research Specialist", desc: "Applied/Medical, solo/independent, directed, research dominant.", strategy: "Research capability. Applied science focus.", evidence: ["Research Spending #1", "Baltimore"] },
            { id: "northwestern", name: "Northwestern", rank: 10, code: "AKDE-MR", persona: "The Applied Communicator", desc: "Applied, kinship/social, directed (Schools), established but modern.", strategy: "The 'AND' DNA. Journalism + Engineering.", evidence: ["Quarter System", "The Rock"] },
            { id: "washu", name: "WashU St. Louis", rank: 24, code: "AKFE-MR", persona: "The Midwest Intellectual", desc: "Applied (Pre-med), high Kinship, Fluid, Research powerhouse.", strategy: "Be nice. High achievement with kindness.", evidence: ["Pre-Med Support", "Residential Life"] },
            { id: "georgetown", name: "Georgetown", rank: 24, code: "ASDE-MU", persona: "The Global Diplomat", desc: "Applied (Policy), Solo (City), Directed, Established. Undergrad focus.", strategy: "Cura Personalis. Service to the world.", evidence: ["SFS", "Jesuit Values"] },

             // SOUTHERN & OTHERS (6)
            { id: "duke", name: "Duke University", rank: 10, code: "AKDE-GR", persona: "The Spirited Leader", desc: "Applied/Active, kinship (school spirit), directed, traditional bubble.", strategy: "Work hard play hard. Interdisciplinary.", evidence: ["Cameron Crazies", "Bass Connections"] },
            { id: "vanderbilt", name: "Vanderbilt", rank: 18, code: "AKFE-MR", persona: "The Happy Balanced", desc: "Applied, kinship (happiest students), fluid/social, metro-integrated.", strategy: "Balance. Happiness. The Commons.", evidence: ["The Commons", "Nashville"] },
            { id: "rice", name: "Rice University", rank: 17, code: "AKFV-MR", persona: "The Unconventional Village", desc: "Applied, intense kinship (Colleges), fluid, visionary/quirky.", strategy: "Culture of Care. Residential College loyalty.", evidence: ["Residential Colleges", "Unconventional Wisdom"] },
            { id: "emory", name: "Emory University", rank: 24, code: "CKFE-MR", persona: "The Wise Heart", desc: "Conceptual/Liberal Arts, kinship, fluid, metro (Atlanta).", strategy: "Public health and liberal arts ethics.", evidence: ["CDC Proximity", "Dooley"] },
            { id: "notredame", name: "Notre Dame", rank: 20, code: "CKDE-GU", persona: "The Faithful Steward", desc: "Conceptual (Values), intense Kinship, Directed, Established. A true 'Grove'.", strategy: "A force for good. Values-based leadership.", evidence: ["Dorm Life", "Catholic Mission"] },
            { id: "unc", name: "UNC Chapel Hill", rank: 27, code: "AKDE-GR", persona: "The Public Leader", desc: "Applied, Kinship (Tar Heels), Directed, Established. The classic 'Grove'.", strategy: "The Carolina Way. Public service.", evidence: ["Public Ivy", "College Town"] },
            
            // PUBLIC POWERHOUSES (8)
            { id: "berkeley", name: "UC Berkeley", rank: 15, code: "ASFV-MR", persona: "The Radical Giant", desc: "Applied/Activist, solo (sink or swim), fluid options, visionary/political.", strategy: "Scale and Grit. Self-starter.", evidence: ["Activism", "Scale"] },
            { id: "ucla", name: "UCLA", rank: 15, code: "AKFE-MR", persona: "The Optimistic Creative", desc: "Applied, kinship (happier vibe than Cal), fluid, metro.", strategy: "Optimism and Impact. Creative capital.", evidence: ["Applications #1", "Hollywood connection"] },
            { id: "usc", name: "USC", rank: 28, code: "AKDV-MR", persona: "The Networked Titan", desc: "Applied (Cinema/Biz), Kinship (Trojan Family), Directed, Visionary.", strategy: "Trojan Family network. Renaissance Scholar.", evidence: ["Trojan Family", "Renaissance Scholars"] },
            { id: "ucsd", name: "UCSD", rank: 28, code: "ASDV-MR", persona: "The Biotech Specialist", desc: "Applied, Solo (College system separates), Directed, Visionary.", strategy: "Research capability. Biotech focus.", evidence: ["Six Colleges", "La Jolla"] },
            { id: "ut", name: "UT Austin", rank: 30, code: "ASDV-MR", persona: "The Innovation Hub", desc: "Applied, Solo (Size), Directed (Majors), Visionary (Austin Tech).", strategy: "Change the world. Keep Austin Weird.", evidence: ["Austin Tech", "Plan II"] },
            { id: "uva", name: "UVA", rank: 24, code: "AKDE-GU", persona: "The Honor Steward", desc: "Applied/Leadership, kinship, directed traditions, grove environment.", strategy: "Student Self-Governance. Honor.", evidence: ["The Lawn", "Student Governance"] },
            { id: "umich", name: "UMich", rank: 21, code: "AKDE-GR", persona: "The Massive Victor", desc: "Applied, kinship (spirit), directed, grove/research hybrid.", strategy: "Leaders and Best. Massive scale.", evidence: ["The Victors", "Ann Arbor"] },
            { id: "uf", name: "Univ of Florida", rank: 30, code: "AKDE-GR", persona: "The Southern Giant", desc: "Applied, Kinship (Gators), Directed, Established/Grove.", strategy: "Gator Nation. Top 5 Public.", evidence: ["Gator Nation", "Research"] },

            // URBAN HUSTLERS & OTHERS (19)
            { id: "nyu", name: "NYU", rank: 30, code: "ASFV-MR", persona: "The Global Citizen", desc: "Applied, Solo, Fluid (City is the campus), Visionary.", strategy: "In and of the City. Hustle.", evidence: ["No Campus", "Global Network"] },
            { id: "bu", name: "Boston University", rank: 41, code: "ASDE-MR", persona: "The City Professional", desc: "Applied, Solo, Directed, Established.", strategy: "Professional preparation in the city.", evidence: ["Commonwealth Ave", "Research"] },
            { id: "northeastern", name: "Northeastern", rank: 53, code: "ASDV-MR", persona: "The Co-op Captain", desc: "Applied, Solo (Rotational), Directed, Visionary (New model).", strategy: "Co-op. Experience over theory.", evidence: ["Co-op Program", "Global Campuses"] },
            { id: "tufts", name: "Tufts University", rank: 37, code: "CKFV-MU", persona: "The Civic Thinker", desc: "Conceptual (IR), Kinship (Jumbos), Fluid, Visionary, Metro-adjacent.", strategy: "Active Citizenship. International focus.", evidence: ["Tisch College", "Jumbo"] },
            { id: "bc", name: "Boston College", rank: 37, code: "CKDE-MU", persona: "The Jesuit Scholar", desc: "Conceptual, Kinship, Directed (Core), Established.", strategy: "Men and women for others. Jesuit.", evidence: ["Jesuit Core", "Service"] },
            { id: "rochester", name: "Univ of Rochester", rank: 44, code: "CKFV-GU", persona: "The Open Scientist", desc: "Conceptual, Kinship, Fluid (Open Curriculum), Visionary.", strategy: "Build your own curriculum. Meliora.", evidence: ["Open Curriculum", "Meliora"] },
            { id: "ucdavis", name: "UC Davis", rank: 33, code: "BKDE-SR", persona: "The Friendly Giant", desc: "Balanced, Kinship, Directed, Service-oriented Research.", strategy: "Collaborative, sustainable, grounded.", evidence: ["Aggie Pride", "Ag/Vet Elite"] },
            { id: "ucirvine", name: "UC Irvine", rank: 33, code: "BADS-IR", persona: "The Modern Researcher", desc: "Balanced, Atomized, Directed, Intellectual Research.", strategy: "Serious academics, gaming/tech focus.", evidence: ["Esports", "Anteaters"] },
            { id: "uiuc", name: "UIUC", rank: 33, code: "AADE-VR", persona: "The Prairie Innovator", desc: "Applied (Eng), Atomized, Directed, Vitality Research.", strategy: "Grainger Engineering excellence.", evidence: ["Research Park", "Greek Life"] },
            { id: "uwmadison", name: "UW Madison", rank: 39, code: "BKDH-VR", persona: "The Badger Spirit", desc: "Balanced, Kinship, Directed, Hybrid Vitality.", strategy: "Work hard play hard on the Isthmus.", evidence: ["The Isthmus", "Badger Pride"] },
            { id: "ucsb", name: "UCSB", rank: 39, code: "BKDG-VR", persona: "The Coastal Scholar", desc: "Balanced, Kinship, Directed, Grove Vitality.", strategy: "Nobel laureates on the beach.", evidence: ["Isla Vista", "Physics"] },
            { id: "osu", name: "Ohio State", rank: 41, code: "AKDM-VR", persona: "The Buckeye Force", desc: "Applied, Kinship, Directed, Metro Vitality.", strategy: "Massive scale and spirit.", evidence: ["The Horseshoe", "Research"] },
            { id: "rutgers", name: "Rutgers", rank: 41, code: "BADS-VR", persona: "The State Engine", desc: "Balanced, Atomized, Directed, Suburban Vitality.", strategy: "Diverse, gritty, research-heavy.", evidence: ["New Brunswick", "Big Ten"] },
            { id: "umd", name: "UMD College Park", rank: 46, code: "AKDS-VR", persona: "The Capital Tech", desc: "Applied, Kinship, Directed, Suburban Vitality.", strategy: "CS/Cyber excellence near DC.", evidence: ["Terps", "DC Proximity"] },
            { id: "uwseattle", name: "UW Seattle", rank: 46, code: "AADM-IR", persona: "The Pacific Titan", desc: "Applied, Atomized, Directed, Metro Intellectual.", strategy: "CS/Med dominance in Seattle.", evidence: ["Udubb", "Microsoft/Amazon"] },
            { id: "lehigh", name: "Lehigh", rank: 46, code: "ASDE-VU", persona: "The Mountain Engineer", desc: "Applied, Stratified, Directed, Enclave Vitality.", strategy: "Work hard play hard on the hill.", evidence: ["The Hill", "Greek Life"] },
            { id: "purdue", name: "Purdue", rank: 46, code: "AKSE-VR", persona: "The Cradle of Astronauts", desc: "Applied, Kinship, Structured, Enclave Vitality.", strategy: "Grit and Engineering.", evidence: ["Boilermakers", "Space History"] },
            { id: "uga", name: "UGA", rank: 46, code: "BKDE-VR", persona: "The Classic Bulldog", desc: "Balanced, Kinship, Directed, Enclave Vitality.", strategy: "Athens college town experience.", evidence: ["SEC Football", "Athens"] },
            { id: "tamu", name: "Texas A&M", rank: 51, code: "AKSE-SR", persona: "The Aggie Cult", desc: "Applied, Kinship, Structured, Enclave Service.", strategy: "Deepest kinship in the nation.", evidence: ["12th Man", "Corps of Cadets"] }
        ];

        // --- GLOBAL STATE ---
        let userCode = null; 
        let quizResults = { M: 0, S: 0, P: 0, Sp: 0, E: 0, F: 0 };
        let comparisonList = [null, null];
        let currentQIndex = 0;

        // --- THE FULL 72-QUESTION ENGINE ---
        const OAD72 = [
            // PART I: THE MIND (C vs A)
            { dim: "M", text: "I want to understand the fundamental theory behind how the universe works.", left: "Understand Theory", right: "Build Solutions" },
            { dim: "M", text: "I prefer writing a 20-page thesis on history, philosophy, or literature.", left: "Write Thesis", right: "Build Project" },
            { dim: "M", text: "My favorite classes are discussion-based seminars where we debate abstract ideas.", left: "Seminars", right: "Labs/Workshops" },
            { dim: "M", text: "I am motivated by curiosity: 'I just need to know the answer.'", left: "Curiosity", right: "Utility" },
            { dim: "M", text: "I would rather spend my summer reading in a library archive.", left: "Library", right: "Internship" },
            { dim: "M", text: "I value 'Pure Mathematics' (proofs, logic, number theory).", left: "Pure Math", right: "Applied Math" },
            { dim: "M", text: "I believe the purpose of college is 'intellectual formation' (shaping the soul).", left: "Formation", right: "Job Prep" },
            { dim: "M", text: "I often ask 'Why is this the way it is?'", left: "Ask Why", right: "Ask How" },
            { dim: "M", text: "I admire the 'Philosopher' archetype (e.g., Plato, Kant).", left: "Philosopher", right: "Builder" },
            { dim: "M", text: "I enjoy dealing with ambiguity and questions that have no clear answer.", left: "Ambiguity", right: "Concrete Answers" },
            { dim: "M", text: "If I ran a company, I would want to be the Chief Vision/Strategy Officer.", left: "Visionary", right: "Operations" },
            { dim: "M", text: "In a zombie apocalypse, I am the one figuring out the cure.", left: "Find Cure", right: "Build Fort" },

            // PART II: THE SOCIAL (S vs K)
            { dim: "S", text: "I work best when I am alone and have total control over the output.", left: "Solo Work", right: "Team Work" },
            { dim: "S", text: "I am comfortable with 'sharp elbows' and intense competition to be #1.", left: "Competition", right: "Collaboration" },
            { dim: "S", text: "I view my peers primarily as competitors or benchmarks.", left: "Competitors", right: "Support Network" },
            { dim: "S", text: "I want to be recognized individually as a 'Star' in my field.", left: "Star", right: "Team Member" },
            { dim: "S", text: "I thrive in high-pressure environments where I sink or swim on my own merit.", left: "Sink or Swim", right: "High Trust" },
            { dim: "S", text: "I often feel held back by group projects; I'd rather just do it myself.", left: "Held Back", right: "Energized" },
            { dim: "S", text: "I respect leaders who are decisive, independent, and uncompromising.", left: "Decisive", right: "Empathetic" },
            { dim: "S", text: "A 'cutthroat' academic atmosphere excites me—it pushes me to be better.", left: "Excites Me", right: "Drains Me" },
            { dim: "S", text: "I prioritize personal achievement and resume-building.", left: "Achievement", right: "Bonding" },
            { dim: "S", text: "I am okay being 'anonymous' in a big city as long as I am successful.", left: "Anonymous", right: "Known by Name" },
            { dim: "S", text: "I believe 'Iron sharpens iron' (Conflict creates growth).", left: "Conflict", right: "Support" },
            { dim: "S", text: "I want to be the Valedictorian (Top of the class).", left: "Valedictorian", right: "Class President" },

            // PART III: THE PATH (F vs D)
            { dim: "P", text: "I hate required courses. Let me choose everything I study.", left: "Free Choice", right: "Roadmap" },
            { dim: "P", text: "I want to explore disparate fields (e.g., Biology AND Poetry) equally.", left: "Explore", right: "Specialize" },
            { dim: "P", text: "I prefer an 'Open Curriculum' (Zero general education requirements).", left: "Open Curr", right: "Core Curr" },
            { dim: "P", text: "I thrive when I have to design my own major or path from scratch.", left: "Design Own", right: "Clear Tracks" },
            { dim: "P", text: "I am intellectually restless; I want to sample a little bit of everything.", left: "Restless", right: "Focused" },
            { dim: "P", text: "I see 'General Education' requirements as a waste of my time.", left: "Waste", right: "Essential" },
            { dim: "P", text: "I want the flexibility to change my major three times if I want to.", left: "Flexibility", right: "Direct Admit" },
            { dim: "P", text: "I like finding connections between things that don't seem to match.", left: "Connections", right: "Progression" },
            { dim: "P", text: "My ideal college experience is 'Choose Your Own Adventure.'", left: "Adventure", right: "Bootcamp" },
            { dim: "P", text: "I am willing to take risks on weird classes even if they lower my GPA.", left: "Risks", right: "Requirements" },
            { dim: "P", text: "I consider myself a 'Polymath' (good at many different things).", left: "Polymath", right: "Specialist" },
            { dim: "P", text: "I would apply 'Undecided' or 'Interdisciplinary Studies.'", left: "Undecided", right: "Specific School" },

            // PART IV: THE SPIRIT (E vs V)
            { dim: "Sp", text: "I value prestige, history, and centuries of tradition.", left: "Tradition", right: "Novelty" },
            { dim: "Sp", text: "I want to join the elite ranks of existing institutions (e.g., Goldman Sachs).", left: "Join Elite", right: "Build New" },
            { dim: "Sp", text: "I love the aesthetic of old libraries, ivy-covered walls, and ancient rituals.", left: "Old Ivy", right: "Modern Lab" },
            { dim: "Sp", text: "I trust wisdom that has stood the test of time.", left: "Timeless Wisdom", right: "Innovation" },
            { dim: "Sp", text: "I want a degree that signals 'Class, Elegance, and Authority.'", left: "Authority", right: "Future-Readiness" },
            { dim: "Sp", text: "I am comfortable with hierarchy and paying my dues.", left: "Hierarchy", right: "Flat Structure" },
            { dim: "Sp", text: "I prefer stability and a guaranteed path to the top.", left: "Stability", right: "High Risk" },
            { dim: "Sp", text: "I resonate with the word 'Stewardship' (protecting what exists).", left: "Stewardship", right: "Disruption" },
            { dim: "Sp", text: "I would feel proudest wearing a Harvard or Yale sweatshirt.", left: "HYP (Old)", right: "Stanford/MIT" },
            { dim: "Sp", text: "I value networking with 'Old Money' and established power brokers.", left: "Old Money", right: "New Money" },
            { dim: "Sp", text: "I believe traditions bind a community together.", left: "Bind Together", right: "Hold Back" },
            { dim: "Sp", text: "I want to be a Senator or a CEO of a Fortune 500.", left: "Senator/CEO", right: "Founder" },

            // PART V: THE ENVIRONMENT (M vs G)
            { dim: "E", text: "I want the city to be my campus. I don't need a 'quad.'", left: "City/No Quad", right: "Campus Bubble" },
            { dim: "E", text: "I want immediate access to internships, nightlife, and culture off-campus.", left: "Access", right: "Community" },
            { dim: "E", text: "I am independent and don't mind navigating a gritty urban environment.", left: "Gritty/Urban", right: "Safe/Green" },
            { dim: "E", text: "I prefer the energy of New York, London, or Los Angeles.", left: "Big City", right: "College Town" },
            { dim: "E", text: "I would get bored stuck on a campus with the same people every day.", left: "Bored", right: "Lonely in City" },
            { dim: "E", text: "I want my college years to feel like 'Real Life' started early.", left: "Real Life", right: "Protected Time" },
            { dim: "E", text: "I don't care about football games or tailgating.", left: "Don't Care", right: "School Spirit" },
            { dim: "E", text: "I prefer 'commuter' style independence (apartment living).", left: "Apartment", right: "Dorm Life" },
            { dim: "E", text: "My dream Saturday is exploring a new neighborhood in the city.", left: "City Explore", right: "Campus Fest" },
            { dim: "E", text: "I prefer a fast-paced environment with constant sensory stimulation.", left: "Fast/Stimulation", right: "Calm/Focus" }, 
            { dim: "E", text: "I want to see non-students (real people) every day.", left: "Real People", right: "Students Only" }, 
            { dim: "E", text: "The idea of a 'College Town' feels claustrophobic to me.", left: "Claustrophobic", right: "Cozy" }, 

            // PART VI: THE FOCUS (R vs U)
            { dim: "F", text: "I want to attend a 'Research Powerhouse' with massive funding and labs.", left: "Research Power", right: "Student Centric" },
            { dim: "F", text: "I am okay being taught by TAs if it means I'm at a world-famous institution.", left: "Okay with TAs", right: "Professors Only" },
            { dim: "F", text: "I am a self-starter who can fight for attention in a big pond.", left: "Fight for Attn", right: "Mentorship" },
            { dim: "F", text: "I prioritize the graduate reputation (Law, Med, PhD strength) of the school.", left: "Grad Rep", right: "Undergrad Exp" },
            { dim: "F", text: "I want to participate in cutting-edge research that leads to publication.", left: "Publication", right: "Personal Growth" },
            { dim: "F", text: "I don't mind large lecture halls (100+ people) for intro classes.", left: "Large Lectures", right: "Small Seminars" },
            { dim: "F", text: "I view professors as famous experts I can learn *from*.", left: "Experts", right: "Mentors" },
            { dim: "F", text: "I want resources, grants, and massive facilities above all else.", left: "Resources", right: "Care/Attention" },
            { dim: "F", text: "I'd rather be a small fish in a massive, prestigious ocean.", left: "Small Fish", right: "Big Fish" },
            { dim: "F", text: "I care more about the library collection size than the dorm quality.", left: "Library/Labs", right: "Dorms/Food" }, 
            { dim: "F", text: "I want to work with PhD students who are changing the field.", left: "PhD Peers", right: "Undergrad Peers" }, 
            { dim: "F", text: "The university's global output matters more than my individual comfort.", left: "Output", right: "Comfort" } 
        ];

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            renderGrid(universities);
        });

        // --- RENDERING ---
        function renderGrid(data) {
            const grid = document.getElementById('school-grid');
            grid.innerHTML = '';

            data.forEach(school => {
                const card = document.createElement('div');
                card.className = "bg-white rounded-xl p-6 border border-olea-primary/5 school-card cursor-pointer flex flex-col h-full";
                card.onclick = () => openModal(school);
                
                // Match Calculation (if user has code)
                let matchBadge = "";
                if(userCode) {
                    const matchScore = calculateMatch(userCode, school.code);
                    const matchColor = matchScore >= 5 ? "bg-green-100 text-green-800" : (matchScore >= 3 ? "bg-yellow-100 text-yellow-800" : "bg-red-100 text-red-800");
                    const matchText = matchScore >= 5 ? "High Match" : (matchScore >= 3 ? "Possible" : "Mismatch");
                    matchBadge = `<span class="px-2 py-1 rounded text-[10px] font-bold uppercase ${matchColor} ml-auto">${matchText}</span>`;
                }

                card.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <span class="text-[10px] font-bold text-stone-400 uppercase tracking-wider">Rank #${school.rank}</span>
                        ${matchBadge}
                    </div>
                    
                    <h3 class="text-xl font-display font-bold text-olea-primary mb-1">${school.name}</h3>
                    <p class="font-mono text-sm text-olea-accent tracking-widest mb-3">${school.code}</p>
                    
                    <p class="text-sm text-stone-600 italic font-light mb-4 flex-grow">"${school.persona}"</p>

                    <div class="border-t border-olea-primary/5 pt-4 mt-auto">
                        <div class="flex gap-1 flex-wrap">
                            ${generatePills(school.code)}
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function generatePills(code) {
            const map = {
                'C': 'Conceptual', 'A': 'Applied',
                'S': 'Solo', 'K': 'Kinship',
                'F': 'Fluid', 'D': 'Directed',
                'E': 'Established', 'V': 'Visionary',
                'M': 'Metro', 'G': 'Grove',
                'R': 'Research', 'U': 'Undergrad'
            };
            // Clean string
            const clean = code.replace('-', '');
            return clean.split('').map(char => 
                `<span class="dna-pill bg-olea-base text-olea-primary border-olea-primary/20">${map[char]}</span>`
            ).join('');
        }

        function filterGrid(type) {
            // Visual Toggle
            document.querySelectorAll('.filter-btn').forEach(b => {
                b.classList.remove('active', 'bg-olea-primary', 'text-white', 'border-olea-primary');
                b.classList.add('text-olea-primary', 'border-olea-primary/20');
                if(b.innerText.includes(`(${type})`) || (type === 'All' && b.innerText === 'All')) {
                    b.classList.add('active', 'bg-olea-primary', 'text-white', 'border-olea-primary');
                    b.classList.remove('text-olea-primary', 'border-olea-primary/20');
                }
            });

            if(type === 'All') {
                renderGrid(universities);
            } else {
                const filtered = universities.filter(u => u.code.includes(type));
                renderGrid(filtered);
            }
        }

        // --- MODAL LOGIC ---
        function openModal(school) {
            const m = document.getElementById('school-modal');
            m.classList.remove('hidden');
            m.classList.add('flex');

            document.getElementById('modal-name').innerText = school.name;
            document.getElementById('modal-rank').innerText = `Rank #${school.rank}`;
            document.getElementById('modal-code').innerText = school.code;
            document.getElementById('modal-persona').innerText = `"${school.persona}"`;
            document.getElementById('modal-strategy').innerText = school.strategy;
            
            // Evidence
            document.getElementById('modal-evidence').innerHTML = school.evidence.map(e => `<li>• ${e}</li>`).join('');
            
            // Values (Derived from Code)
            const valueMap = {
                'C': 'Values Theory & "Why"', 'A': 'Values Practice & "How"',
                'S': 'Values Independence', 'K': 'Values Community',
                'F': 'Values Exploration', 'D': 'Values Structure',
                'E': 'Values Tradition', 'V': 'Values Disruption',
                'M': 'City Integration', 'G': 'Campus Bubble',
                'R': 'Research Power', 'U': 'Student Focus'
            };
            const chars = school.code.replace('-','').split('');
            document.getElementById('modal-values').innerHTML = chars.map(c => `<li>${valueMap[c]}</li>`).join('');

            // DNA Visuals (Sliders)
            renderDNASliders(school.code);

            // Compare Btn
            const btn = document.getElementById('modal-compare-btn');
            btn.onclick = () => addToCompare(school);
        }

        function closeModal() {
            document.getElementById('school-modal').classList.add('hidden');
            document.getElementById('school-modal').classList.remove('flex');
        }

        function renderDNASliders(code) {
            const container = document.getElementById('modal-dna-visuals');
            container.innerHTML = '';
            
            const dims = [
                { l: 'Conceptual', r: 'Applied', k: ['C', 'A'] },
                { l: 'Solo', r: 'Kinship', k: ['S', 'K'] },
                { l: 'Fluid', r: 'Directed', k: ['F', 'D'] },
                { l: 'Established', r: 'Visionary', k: ['E', 'V'] },
                { l: 'Metro', r: 'Grove', k: ['M', 'G'] },
                { l: 'Research', r: 'Undergrad', k: ['R', 'U'] }
            ];

            dims.forEach(d => {
                const isLeft = code.includes(d.k[0]);
                const pos = isLeft ? '10%' : '90%';
                
                const div = document.createElement('div');
                div.innerHTML = `
                    <div class="flex justify-between text-[10px] uppercase font-bold text-stone-400 mb-1">
                        <span class="${isLeft ? 'text-olea-primary' : ''}">${d.l}</span>
                        <span class="${!isLeft ? 'text-olea-primary' : ''}">${d.r}</span>
                    </div>
                    <div class="h-2 bg-stone-100 rounded-full relative overflow-hidden">
                        <div class="absolute top-0 bottom-0 w-1/2 bg-olea-primary/20 ${isLeft ? 'left-0' : 'right-0'}"></div>
                        <div class="absolute top-0 bottom-0 w-2 bg-olea-primary rounded-full transition-all duration-500" style="left: ${pos}"></div>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // --- QUIZ LOGIC (72 QUESTIONS - 1 CLICK) ---
        function startQuiz() {
            currentQIndex = 0;
            quizResults = { M: 0, S: 0, P: 0, Sp: 0, E: 0, F: 0 };
            document.getElementById('quiz-modal').classList.remove('hidden');
            document.getElementById('quiz-question-container').classList.remove('hidden');
            document.getElementById('quiz-result-view').classList.add('hidden');
            document.getElementById('quiz-result-view').classList.remove('flex');
            renderQuestion();
        }

        function closeQuiz() {
            document.getElementById('quiz-modal').classList.add('hidden');
        }

        function renderQuestion() {
            const q = OAD72[currentQIndex];
            document.getElementById('quiz-step').innerText = currentQIndex + 1;

            // Section Titles
            let sectionTitle = "";
            if(currentQIndex < 12) sectionTitle = "Part I: The Mind (Conceptual vs Applied)";
            else if(currentQIndex < 24) sectionTitle = "Part II: The Social (Solo vs Kinship)";
            else if(currentQIndex < 36) sectionTitle = "Part III: The Path (Fluid vs Directed)";
            else if(currentQIndex < 48) sectionTitle = "Part IV: The Spirit (Established vs Visionary)";
            else if(currentQIndex < 60) sectionTitle = "Part V: The Environment (Metro vs Grove)";
            else sectionTitle = "Part VI: The Focus (Research vs Undergrad)";
            
            document.getElementById('quiz-section-title').innerText = sectionTitle;
            document.getElementById('quiz-text').innerText = q.text;
            
            // Display Choices
            document.getElementById('opt-1-text').innerText = q.left;
            document.getElementById('opt-2-text').innerText = q.right;
        }

        function handleAnswer(score) {
            const q = OAD72[currentQIndex];
            quizResults[q.dim] += score;
            
            currentQIndex++;
            if(currentQIndex < OAD72.length) {
                renderQuestion();
            } else {
                calculateResults();
            }
        }

        function calculateResults() {
            const getChar = (dim, leftChar, rightChar) => {
                return quizResults[dim] > 36 ? rightChar : leftChar;
            };
            
            let c1 = getChar('M', 'C', 'A');
            let c2 = getChar('S', 'S', 'K');
            let c3 = getChar('P', 'F', 'D');
            let c4 = getChar('Sp', 'E', 'V');
            let c5 = getChar('E', 'M', 'G');
            let c6 = getChar('F', 'R', 'U');

            userCode = `${c1}${c2}${c3}${c4}-${c5}${c6}`;
            
            // Show Result
            document.getElementById('quiz-question-container').classList.add('hidden');
            const resultView = document.getElementById('quiz-result-view');
            resultView.classList.remove('hidden');
            resultView.classList.add('flex');
            
            document.getElementById('result-code-final').innerText = userCode;
            document.getElementById('user-code-display').innerText = userCode;
            
            const names = {
                'CSFE': 'The Philosopher King',
                'AKDV': 'The Happy Engineer',
                'CSDE': 'The Intellectual Warrior',
                'ASFE': 'The Applied Star',
                'CKFE': 'The Humanist',
                'AKDE': 'The Spirited Leader',
                'CKFV': 'The Happy Architect'
            };
            const base = userCode.split('-')[0];
            document.getElementById('result-archetype-name').innerText = names[base] || "The Unique Strategist";
        }

        function finalizeQuiz() {
            closeQuiz();
            renderGrid(universities);
        }

        function calculateMatch(student, school) {
            let score = 0;
            for(let i=0; i<4; i++) if(student[i] === school[i]) score++;
            if(student[5] === school[5]) score++;
            if(student[6] === school[6]) score++;
            return score;
        }

        // --- COMPARISON TRAY ---
        function toggleComparison() {
            const t = document.getElementById('comparison-tray');
            t.classList.toggle('translate-y-full');
        }

        function addToCompare(school) {
            if(comparisonList[0] === null) comparisonList[0] = school;
            else comparisonList[1] = school;
            updateCompareUI();
            document.getElementById('comparison-tray').classList.remove('translate-y-full');
        }

        function updateCompareUI() {
            comparisonList.forEach((s, i) => {
                const el = document.getElementById(`slot-${i}`);
                if(s) {
                    el.innerHTML = `
                        <div class="flex justify-between font-bold text-olea-primary text-sm mb-1">
                            ${s.name} <button onclick="clearSlot(${i})" class="text-red-400 hover:text-red-600">x</button>
                        </div>
                        <div class="text-[10px] font-mono text-olea-accent">${s.code}</div>
                    `;
                    el.className = "p-3 bg-white border border-olea-primary/20 rounded shadow-sm text-left";
                } else {
                    el.innerHTML = "Empty Slot";
                    el.className = "p-4 bg-stone-50 rounded border border-dashed border-stone-300 text-center text-xs text-stone-400";
                }
            });
        }

        function clearSlot(i) {
            comparisonList[i] = null;
            updateCompareUI();
        }

        function resetApp() {
            userCode = null;
            document.getElementById('user-code-display').innerText = "GUEST";
            renderGrid(universities);
        }

    </script>
</body>
</html>
